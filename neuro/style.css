:root {
    --ocean-deep: #0a192f;
    --neon-blue: #00d4ff;
    --neon-orange: #ff9d00;
    --pearl-white: #e0f7fa;
    --glass-bg: rgba(255, 255, 255, 0.1);
    --active-btn: #00bcd4;
    --inactive-btn: rgba(255, 255, 255, 0.1);
    
    /* --- НАЛАШТУВАННЯ АБАКУСА --- */
    --bead-width: 40px;
    --bead-height: 30px;
    --col-width: 40px;
    --col-height: 280px;
    
    /* Налаштування зміщення кісточок */
    --shift-upper: 35px;  /* Верхня йде ВНИЗ */
    --shift-lower: -45px; /* Нижні йдуть ВГОРУ */
    
    --col-gap: 15px;
}

body.neuro-ocean {
    background: radial-gradient(circle at center, #112240 0%, #0a192f 100%);
    color: white;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    touch-action: manipulation; 
    overflow-x: hidden;
}

.mobile-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px;
    min-height: 100vh;
}

/* --- ПЕРЕМИКАЧ РЕЖИМІВ --- */
.mode-switcher {
    display: flex;
    background: rgba(0,0,0,0.3);
    border-radius: 20px;
    padding: 5px;
    margin-bottom: 10px;
    border: 1px solid var(--neon-blue);
}

.mode-btn {
    background: transparent;
    border: none;
    color: #8892b0;
    padding: 8px 15px;
    border-radius: 15px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
}

.mode-btn.active {
    background: var(--active-btn);
    color: var(--ocean-deep);
    box-shadow: 0 0 10px rgba(0, 188, 212, 0.4);
}

/* --- НАМИСТО --- */
.necklace-panel {
    width: 95%;
    max-width: 400px;
    background: rgba(10, 25, 47, 0.6);
    border-radius: 15px;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px dashed var(--neon-blue);
}

.necklace-container {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 5px;
    flex-wrap: wrap;
}

.pearl-slot {
    width: 25px;
    height: 25px;
    border-radius: 50%;
    border: 2px solid #555;
    background: rgba(0,0,0,0.5);
    transition: all 0.5s ease;
}

/* --- АНІМАЦІЯ ПОЯВИ ПЕРЛИНИ (POP-IN + FLASH) --- */
@keyframes pearl-pop {
    0% {
        transform: scale(0);
        opacity: 0;
        background: #ffffff; /* Починаємо з яскраво-білого (спалах) */
        box-shadow: 0 0 50px 20px rgba(255, 255, 255, 1); /* Велике біле сяйво */
        border-color: #fff;
    }
    50% {
        transform: scale(1.5); /* Пружина: збільшуємо більше норми */
        background: #ffffff; /* Все ще біла */
        box-shadow: 0 0 25px 10px rgba(255, 255, 255, 0.8);
    }
    100% {
        transform: scale(1); /* Повертаємо до нормального розміру */
        /* Колір background тут автоматично стане таким, як у класі .p-color-X */
        box-shadow: 0 0 10px currentColor; /* Сяйво стає кольоровим */
    }
}

.pearl-slot.filled {
    border-color: #fff;
    /* cubic-bezier дає ефект "пружності" */
    animation: pearl-pop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

/* Кольори для різних перлин */
.p-color-0 { background: radial-gradient(circle at 30%, #fff, #ff9a9e); color: #ff9a9e; }
.p-color-1 { background: radial-gradient(circle at 30%, #fff, #a18cd1); color: #a18cd1; }
.p-color-2 { background: radial-gradient(circle at 30%, #fff, #84fab0); color: #84fab0; }
.p-color-3 { background: radial-gradient(circle at 30%, #fff, #fbc2eb); color: #fbc2eb; }
.p-color-4 { background: radial-gradient(circle at 30%, #fff, #f6d365); color: #f6d365; }

.progress-info {
    font-size: 0.8rem;
    color: var(--neon-blue);
    text-align: center;
}
/* --- СТАНДАРТНІ ЕЛЕМЕНТИ --- */
header .header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 15px;
    width: 100%;
    box-sizing: border-box;
}

.logo { font-size: 1.2rem; color: var(--neon-blue); font-weight: bold; }
.sound-toggle { background: transparent; border: 1px solid var(--neon-blue); color: var(--neon-blue); border-radius: 50%; width: 36px; height: 36px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
.sound-toggle.playing { background: rgba(0, 212, 255, 0.2); box-shadow: 0 0 10px var(--neon-blue); }

.daily-mission { width: 100%; display: flex; justify-content: center; margin: 5px 0; }
.mission-box { background: rgba(10, 25, 47, 0.85); backdrop-filter: blur(10px); border: 1px solid var(--neon-blue); border-radius: 15px; padding: 15px; text-align: center; width: 95%; max-width: 400px; }

.hidden { display: none !important; }

.difficulty-selector { margin-bottom: 10px; }
.target-display { font-size: 1.8rem; font-weight: bold; color: var(--pearl-white); text-shadow: 0 0 10px var(--neon-blue); }

/* --- АБАКУС ТА КІСТОЧКИ --- */
.abacus-system { flex-grow: 1; display: flex; flex-direction: column; align-items: center; width: 100%; margin-top: 10px;}
.abacus-frame { 
    background: rgba(0,0,0,0.6); 
    padding: 15px 5px; 
    border: 3px solid #5d4037; 
    border-radius: 12px; 
    width: 95vw; 
    max-width: 600px; 
    overflow-x: auto; 
    display: flex; 
    justify-content: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}
.abacus { display: flex; gap: var(--col-gap); padding: 0 10px; }
.column { display: flex; flex-direction: column; align-items: center; position: relative; width: var(--col-width); height: var(--col-height); flex-shrink: 0; }
.column::before { content: ""; position: absolute; height: 100%; width: 4px; background: linear-gradient(to bottom, transparent, var(--neon-blue), transparent); z-index: 0; }
.column::after { content: ""; position: absolute; top: calc(var(--col-height) * 0.25); width: calc(var(--col-width) + 10px); height: 8px; background: #5d4037; z-index: 1; border-radius: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }

/* Стиль кісточки */
.bead { 
    width: var(--bead-width); 
    height: var(--bead-height); 
    background: radial-gradient(circle at 30% 30%, #555, #111); 
    border-radius: 50%; 
    cursor: pointer; 
    z-index: 2; 
    position: relative; 
    touch-action: none; 
    /* Плавне повернення назад */
    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), background 0.3s, box-shadow 0.3s;
}

/* --- АНІМАЦІЯ ПУЛЬСАЦІЇ --- */
@keyframes active-pulse {
    0% {
        transform: translateY(var(--move-y)) scale(1);
        box-shadow: 0 0 10px var(--neon-orange);
    }
    50% {
        transform: translateY(var(--move-y)) scale(1.15); /* Пульсація */
        box-shadow: 0 0 25px var(--neon-orange), 0 0 10px #fff; /* Яскравий спалах */
    }
    100% {
        transform: translateY(var(--move-y)) scale(1);
        box-shadow: 0 0 10px var(--neon-orange);
    }
}

/* Активована кісточка */
.bead.active { 
    background: radial-gradient(circle at 30% 30%, #fff, var(--neon-orange)); 
    z-index: 10; 
    /* Запускаємо анімацію переміщення+пульсації */
    animation: active-pulse 2s infinite ease-in-out;
}

/* Визначаємо куди їхати для верхніх і нижніх через змінну */
.upper .bead.active { --move-y: var(--shift-upper); }
.lower .bead.active { --move-y: var(--shift-lower); }

.upper { height: calc(var(--col-height) * 0.25); display: flex; align-items: flex-start; padding-bottom: 5px; }
.lower { height: calc(var(--col-height) * 0.70); display: flex; flex-direction: column; justify-content: flex-end; gap: 3px; padding-top: 5px; }

.energy-panel { 
    margin-top: 15px; 
    padding: 5px 30px; 
    border-radius: 30px; 
    background: var(--glass-bg); 
    border: 1px solid var(--neon-orange); 
    box-shadow: 0 0 10px rgba(255, 157, 0, 0.2);
}
.neuro-value { font-size: 32px; color: var(--neon-orange); font-weight: bold; }

.controls-panel { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
.mission-btn { background: var(--neon-blue); color: var(--ocean-deep); border: none; padding: 12px; border-radius: 8px; font-weight: bold; }
.reset-btn { background: rgba(255, 62, 62, 0.2); color: #ff3e3e; border: 1px solid #ff3e3e; padding: 12px; border-radius: 8px; font-weight: bold;}

/* Перлина перемоги (велика анімація по центру) */
.pearl-container { height: 60px; display: flex; justify-content: center; align-items: center; position: relative; margin-bottom: 10px;}
.pearl { width: 40px; height: 40px; background: radial-gradient(circle at 30% 30%, #fff, gold); border-radius: 50%; box-shadow: 0 0 15px gold; }
.pearl-flash { position: absolute; width: 60px; height: 60px; background: white; border-radius: 50%; opacity: 0; }
.animate-flash { animation: flash 0.5s ease-out; }
@keyframes flash { 0% { transform: scale(0); opacity: 1; } 100% { transform: scale(3); opacity: 0; } }

/* Глобальна перемога */
.grand-victory { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); z-index: 999; display: flex; justify-content: center; align-items: center; }
.victory-content { text-align: center; color: var(--neon-orange); animation: popIn 0.5s; }
@keyframes popIn { 0%{transform: scale(0);} 80%{transform: scale(1.1);} 100%{transform: scale(1);} }

@media (max-width: 480px) {
    :root { --bead-width: 34px; --bead-height: 26px; --col-width: 34px; --col-height: 240px; --shift-upper: 30px; --shift-lower: -38px; --col-gap: 8px; }
    .abacus-frame { justify-content: flex-start; }
}